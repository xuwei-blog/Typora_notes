# å¾®æœºåŸç†

## æ¦‚è¿°

[TOC]

### éœ€è¦è¡¥çš„çŸ¥è¯†ç‚¹

1. é”å­˜å™¨
2. ä¸‰æ€é—¨

## å¾®æœºçš„åŸºç¡€çŸ¥è¯†

### å¾®æœºå’Œå•ç‰‡æœº

å¾®æœºæ˜¯å…·æœ‰å®Œæ•´è¿ç®—åŠæ§åˆ¶åŠŸèƒ½çš„è®¡ç®—æœºï¼ŒåŒ…æ‹¬å¾®å¤„ç†å™¨ï¼ˆCPUï¼‰ã€å­˜å‚¨å™¨ã€æ¥ å£é€‚é…å™¨ä»¥åŠè¾“å…¥è¾“å‡ºè®¾å¤‡ã€æ€»çº¿ç³»ç»Ÿç­‰ã€‚

![image-20221211225324191](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221211225324191.png)

å°†å¾®å¤„ç†å™¨ã€ä¸€å®šå®¹é‡çš„RAMå’ŒROMä»¥åŠI/Oå£ã€å®šæ—¶å™¨ç­‰ç”µè·¯ é›†æˆåœ¨ä¸€å—èŠ¯ç‰‡ä¸Šï¼Œæ„æˆå•ç‰‡æœº

![image-20221211225354895](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221211225354895.png)

### å¾®æœºçš„ç»„æˆ

![image-20221211225907655](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221211225907655.png)

#### è¿ç®—å™¨

ç®—æœ¯é€»è¾‘å•å…ƒï¼ˆALUï¼‰ã€ç´¯åŠ å™¨å’Œå¯„å­˜å™¨ç­‰å‡ éƒ¨åˆ†ç»„æˆã€‚

 ALUçš„ä½œç”¨ï¼šæ˜¯æŠŠä¼ é€åˆ°å¾®å¤„ç†å™¨çš„æ•°æ®è¿›è¡Œç®—æœ¯æˆ–é€»è¾‘è¿ç®—ã€‚

 ALUå…·æœ‰ä¸¤ä¸ªä¸»è¦çš„è¾“å…¥æ¥æºï¼šä¸€ä¸ªæ¥è‡ªç´¯åŠ å™¨ï¼Œå¦ä¸€ä¸ªæ¥è‡ªæ•°æ®å¯„å­˜å™¨ã€‚ 

è¿ç®—å™¨æœ‰ä¸¤ä¸ªä¸»è¦çš„åŠŸèƒ½ï¼šæ‰§è¡Œå„ç§ç®—æœ¯è¿ç®—ï¼›æ‰§è¡Œå„ç§é€»è¾‘è¿ç®—ã€‚

#### æ§åˆ¶å™¨

ç¨‹åºè®¡æ•°å™¨(PC)ã€æŒ‡ä»¤å¯„å­˜å™¨ï¼ˆIRï¼‰ã€æŒ‡ä»¤è¯‘ç å™¨ï¼ˆIDï¼‰ã€ æ—¶åºå‘ç”Ÿå™¨å’Œæ“ä½œæ§åˆ¶å™¨ç­‰ç»„æˆã€‚ 

æ§åˆ¶å™¨çš„ä¸»è¦åŠŸèƒ½æœ‰ï¼š 

- ä»å†…å­˜ä¸­å–å‡ºä¸€æ¡æŒ‡ä»¤ï¼Œå¹¶æŒ‡å‡ºä¸‹ä¸€æ¡æŒ‡ä»¤åœ¨å†…å­˜ä¸­çš„ä½ç½® 

- å¯¹æŒ‡ä»¤è¿›è¡Œè¯‘ç æˆ–æµ‹è¯•ï¼Œå¹¶äº§ç”Ÿç›¸åº”çš„æ“ä½œæ§åˆ¶ä¿¡å· 

- æŒ‡æŒ¥å¹¶æ§åˆ¶CPUã€å†…å­˜å’Œè¾“å…¥/è¾“å‡ºè®¾å¤‡ä¹‹é—´æ•°æ®æµåŠ¨çš„æ–¹å‘

#### å·¥ä½œè¿‡ç¨‹

ä¸æ–­çš„å–æŒ‡ã€æ‰§æŒ‡ï¼Œå–æŒ‡ã€æ‰§æŒ‡ï¼Œå¾ªç¯å¾€å¤æ‰§è¡Œç¨‹åºçš„è¿‡ç¨‹ã€‚

#### å­˜å‚¨å™¨

##### è¯»å†™å­˜å‚¨å™¨ï¼ˆRAMï¼‰

éšæœºå­˜å–å­˜å‚¨å™¨ï¼Œåˆç§°æ•°æ®å­˜å‚¨å™¨

- é™æ€RAMï¼šä¾é ==è§¦å‘å™¨==å­˜å‚¨æ¯ä½äºŒè¿›åˆ¶â€œ0â€â€œ1â€ä¿¡æ¯ã€‚

- åŠ¨æ€RAMï¼šä¾é å­˜å‚¨==ç”µå®¹==å¯„å­˜äºŒè¿›åˆ¶ä¿¡æ¯ã€‚

##### åªè¯»å­˜å‚¨å™¨ï¼ˆROMï¼‰

ç¨‹åºå­˜å‚¨å™¨

- æ©è†œROM

æ©è†œæŠ€æœ¯ï¼Œç”Ÿäº§æ—¶å°†ç¨‹åºå›ºåŒ–åœ¨èŠ¯ç‰‡

- PROM 

ç†”ä¸æ–­è£‚å‹ROMï¼Œçƒ­ç†”ä¸å­˜æ”¾01ä¿¡æ¯ï¼Œæ–­äº†å°±æ˜¯1ï¼Œç”Ÿäº§æ—¶å°†ç¨‹åºå›ºåŒ–åœ¨èŠ¯ç‰‡å†…

- EPROM

å¯ç´«å¤–å…‰æ“¦é™¤çš„ROM

-  EÂ²PROM

å¯ä»¥ç”µæ“¦é™¤

-  Flash

å¯ç”µæ“¦é™¤ï¼Œå•ç‰‡æœºä¸­å°±æ˜¯4KBçš„Flashçš„ROM

### è¿›åˆ¶è½¬æ¢

![image-20221211231730496](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221211231730496.png)

![image-20221211231752518](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221211231752518.png)

![image-20221211231806592](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221211231806592.png)

### è®¡ç®—æœºå¸¸ç”¨ç¼–ç 

#### BCDç 

åˆç§°8421ç ï¼Œè¶…è¿‡æ˜¯è¿›åˆ¶9çš„åŠ å‡æ³•è¿ç®—ï¼Œè¦ï¼‹6ä¿®æ­£ã€‚å› ä¸º16è¿›åˆ¶å’Œ10è¿›åˆ¶ï¼Œè¿›åˆ¶æ•°ç›¸å·®6

#### ASCIIç 

7ä½äºŒè¿›åˆ¶

### æ•°æ®çš„è¡¨ç¤ºå½¢å¼

#### æœ‰ç¬¦å·æ•°

æœ€é«˜ä½æ˜¯ç¬¦å·ä½ï¼Œ0æ­£1è´Ÿ

åŸç 

åç 

è¡¥ç 

#### æ— ç¬¦å·æ•°

æ²¡æœ‰ç¬¦å·ä½ï¼Œå…¨æ˜¯æ•°æ®ä¸º

#### å°æ•°ç‚¹è¡¨ç¤ºæ–¹æ³•

##### å®šç‚¹æ•°

##### æµ®ç‚¹æ•°

## å•ç‰‡æœºçš„ç»“æ„å’ŒåŸç†

### MCS-51å•ç‰‡æœºçš„ç»“æ„

æ¯ä¸€ç‰‡å•ç‰‡æœºåŒ…æ‹¬

1.  ä¸€ä¸ª8ä½CPU 
2. ç‰‡å†…256å­—èŠ‚RAMï¼ˆ128B/256Bï¼‰
3. ç‰‡å†…4K ROM 
4. 4ä¸ª8ä½å¹¶è¡ŒI/Oç«¯å£P0~P3 
5. ä¸¤ä¸ªæˆ–3ä¸ª16ä½çš„å®šæ—¶/è®¡æ•°å™¨  
6. 5ä¸ªä¸­æ–­æº 
7. ä¸€ä¸ªå…¨åŒå·¥UARTï¼ˆé€šç”¨å¼‚æ­¥æ”¶å‘ï¼‰ä¸²è¡ŒI/Oå£ 
8.  ç‰‡å†…æŒ¯è¡å™¨å’Œæ—¶é’Ÿäº§ç”Ÿå™¨

![image-20221212000855045](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221212000855045.png)

> SFR ç‰¹æ®ŠåŠŸèƒ½å¯„å­˜å™¨

1. ä¸­å¤®å¤„ç†å•å…ƒï¼ˆCPU ï¼‰ 
   - è¿ç®—å™¨ 
   - æ§åˆ¶å™¨ 
2. å­˜å‚¨å™¨ 
   - ç¨‹åºå­˜å‚¨å™¨ï¼ˆROM ï¼‰
   - æ•°æ®å­˜å‚¨å™¨ï¼ˆRAM ï¼‰ 
3. I/Oæ¥å£ å››ä¸ª 8ä½å¹¶è¡ŒI/Oæ¥å£P0 ï½P3

![image-20221212001700904](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221212001700904.png)

> TMP æš‚å­˜å™¨ ï¼š ä¸´æ—¶å­˜æ”¾æ•°æ®ç»™ALU
>
> ACC ç´¯åŠ å™¨
>
> Bå¯„å­˜å™¨   ä¹˜é™¤æ³•è¿ç®—
>
> å¸ƒå°”å¤„ç†å™¨ å¤„ç†ä½æ“ä½œï¼Œä»¥PSWä¸­çš„CY(C)ä¸ºå…¶ç´¯åŠ å™¨
>
> PSW  ç¨‹åºçŠ¶æ€å­—
>
> IE IP å’Œä¸­æ–­æœ‰å…³çš„å¯„å­˜å™¨
>
> SBUF PCON SCON å’Œä¸²è¡Œå£æœ‰å…³çš„å¯„å­˜å™¨
>
> TH TL TMOD TCON å’Œè®¡æ—¶å™¨æœ‰å…³çš„å¯„å­˜å™¨
>
> å·¦ä¸‹è§’ ç‰‡å†… ç‰‡å¤–æŒ¯è¡ç”µè·¯

### MCS-51å•ç‰‡æœºå¼•è„šåŠå…¶åŠŸèƒ½

åŒåˆ—ç›´æ’å¼å•ç‰‡æœº

- å‡¹æ§½å·¦è¾¹ä¸º1å·å¼•è„š
- å‡¹æ§½å³è¾¹ä¸º40å·å¼•è„š

![image-20221212234028324](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221212234028324.png)

> Vcc ç”µæºå¼•è„š +5ä¼ç›´æµç”µ
>
> Vss æ¥åœ°å¼•è„š

#### æŒ¯è¡ç”µè·¯

![image-20221212234548686](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221212234548686.png)

> å¤–éƒ¨æ™¶æŒ¯ç”µè·¯é€šè¿‡XTAL1 XTAL2æ¥åˆ°å†…éƒ¨æ—¶é’Ÿï¼Œå½¢æˆæŒ¯è¡å›è·¯ï¼Œäº§ç”Ÿäº†æ™¶æŒ¯é¢‘ç‡fosc
>
> foscè¾“å‡ºé¢‘ç‡ 12MHZ ~ 24MHZ

#### å¤–æ¥æ—¶é’Ÿ

![image-20221212234841230](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221212234841230.png)

#### CPUæ—¶åº

- fosc: æŒ¯è¡é¢‘ç‡ 0~24MHZ
  - Tosc: æŒ¯è¡å‘¨æœŸ
- æ—¶é’Ÿå‘¨æœŸï¼ˆæœºå™¨çŠ¶æ€æ—¶é—´ S ï¼‰
  - ä¸¤å€æŒ¯è¡å‘¨æœŸï¼ˆç›¸ä½P1ï¼Œç›¸ä½P2 ï¼‰
- æœºå™¨å‘¨æœŸï¼šCPUè®¿é—®å­˜å‚¨å™¨ä¸€æ¬¡æ‰€éœ€çš„æ—¶é—´
  - ä¸€ä¸ªæœºå™¨å‘¨æœŸ=12ä¸ªæŒ¯è¡å‘¨æœŸ
-  æŒ‡ä»¤å‘¨æœŸï¼šCPUæ‰§è¡Œä¸€æ¡æŒ‡ä»¤æ‰€éœ€è¦çš„æ—¶é—´
  - 1~4ä¸ªæœºå™¨å‘¨æœŸ

> æŒ¯è¡å‘¨æœŸ =  1 / ğ‘“ğ‘œğ‘ ğ‘ =  1  / 12 ğ‘€ğ»ğ‘§ = 0.0833  ğœ‡ğ‘  
>
> çŠ¶æ€å‘¨æœŸ =  2  / ğ‘“ğ‘œğ‘ ğ‘ =  2  / 12 ğ‘€ğ»ğ‘§ = 0.167  ğœ‡ğ‘  
>
> æœºå™¨å‘¨æœŸ =  12  / ğ‘“ğ‘œğ‘ ğ‘ =  12 /12 ğ‘€ğ»ğ‘§ = 1  ğœ‡ğ‘  
>
> æŒ‡ä»¤å‘¨æœŸ =  1 ~ 4 æœºå™¨å‘¨æœŸ = 1~4  ğœ‡ğ‘ 

![image-20221212235914814](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221212235914814.png)

#### æ§åˆ¶å¼•è„š

RST / V~pd~ ï¼š å¤ä½å¼•è„šï¼Œé«˜ç”µå¹³æœ‰æ•ˆ

ALE / PROG:

- ä¸è®¿é—®ç‰‡å¤–å­˜å‚¨å™¨æ—¶
  - è¾“å‡ºæ­£å‘è„‰å†²ä¿¡å·ï¼Œé¢‘ç‡ä¸º1/6 fosc
- è®¿é—®ç‰‡å¤–å­˜å‚¨å™¨æ—¶
  - ALEæ¥åœ°å€é”å­˜å™¨74LS373çš„Gç«¯
    - ALEé«˜ï¼š74LS373è¾“å‡ºåœ°å€
    - ALEé«˜åˆ°ä½ï¼š74LS373é”å­˜åœ°å€

>å½“89C51è¦åœ¨ç‰‡å¤–æ‰©å±•å­˜å‚¨å™¨ï¼Œè¦æ¥ä¸Šä¸€ä¸ªåœ°å€é”å­˜å™¨373ï¼Œä½œç”¨æ˜¯æŠŠä»P0å£çš„æ•°æ®å’Œåœ°å€åˆ†å¼€
>
>ä»373å‡ºæ¥çš„æ˜¯8ä½åœ°å€çº¿ï¼Œæ•°æ®çº¿ä»P0å£å‡ºæ¥

> ALEçš„ä½œç”¨ æ¥åˆ°373çš„Gç«¯ï¼Œä¹Ÿå°±æ˜¯373çš„æ—¶é’Ÿå¼•è„šç«¯ï¼Œå¯¹373é”å­˜åœ°å€è¿›è¡Œæ§åˆ¶

$\overline{\text{PSEN}}$ ï¼š

- ç¨‹åºå­˜å‚¨å…è®¸è¾“å‡ºä¿¡å·ç«¯
- æ¥åœ¨EPROMçš„$\overline{\text{OE}}$ ç«¯

$\overline{\text{EA}}$ / VPP :

- å¤–éƒ¨ç¨‹åºå­˜å‚¨å™¨åœ°å€å…è®¸è¾“å…¥ç«¯
- é«˜ç”µå¹³ï¼šè®¿é—®ç‰‡å†…EPROM/ROM 
- ä½ç”µå¹³ï¼šè®¿é—®ç‰‡å¤–EPROM/ROM

- 8031 ï¼š$\overline{\text{EA}}$æ¥åœ° ï¼ˆå› ä¸ºç‰‡å†…æ²¡æœ‰ROMï¼‰

#### I/Oå¼•è„š

- P0å£
  - é€šç”¨I/Oå£
  - è®¿é—®ç‰‡å¤–å­˜å‚¨å™¨æ—¶ï¼Œä½8ä½åœ°å€/æ•°æ®
- P1å£
  - é€šç”¨I/Oå£
- P2å£
  - é€šç”¨I/På£
  - è®¿é—®ç‰‡å¤–å­˜å‚¨å™¨æ—¶  ï¼Œé«˜ 8ä½åœ°å€
- P3å£
  - é€šç”¨I/O å£
  - åšæ§åˆ¶ç”¨ï¼Œæ¯ä¸ªå¼•è„šåŠŸèƒ½ä¸åŒ

![image-20221213002354107](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221213002354107.png)

### å­˜å‚¨å™¨åˆ†ç±»

![image-20221214125433620](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221214125433620.png)



#### ç¨‹åºå­˜å‚¨å™¨åœ°å€ç©ºé—´

1. é€šè¿‡16ä½ç¨‹åºè®¡æ•°å™¨PCå¯»å€ï¼Œ$\frac{2^{16}}{1024} = 64KB$æœ€å¤§å¯»å€ç©ºé—´64K

2. ç¨‹åºå­˜å‚¨ç©ºé—´ç‰‡å†…ROM 4K 0000H~0FFFH 

   ç¨‹åºå­˜å‚¨ç©ºé—´ç‰‡å¤–ROM 64K 0000H~FFFFH

3. $\overline{EA}$æ¥==é«˜==ç”µå¹³ï¼Œè®¿é—®ç‰‡å†…ROMï¼Œ$\overline{EA}$æ¥==ä½==ç”µå¹³ï¼Œè®¿é—®ç‰‡å¤–ROM

4. 8031æ²¡æœ‰ç‰‡å†…ROMï¼Œ$\overline{EA}$æ¥åœ°

5. 89C51 ç‰‡å†…ï½¤ç‰‡å¤–ROMå­˜å–é€Ÿåº¦ç›¸ç­‰

   $\because$ è®¿é—®ROMçš„æŒ‡ä»¤éƒ½æ˜¯  MOCV

#### ä¸­æ–­çŸ¢é‡åœ°å€

![image-20221214131344560](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221214131344560.png)

> 0000Hæ˜¯å¼€æœºåæ‰§è¡Œçš„ç¬¬ä¸€æ¡æŒ‡ä»¤ï¼Œè·³è½¬åˆ°ä¸»ç¨‹åº

> é¦–åœ°å€æ˜¯ä¸­æ–­çŸ¢é‡åœ°å€ï¼Œåœ¨è¯¥åœ°å€ä¸‹æ‰§è¡Œè½¬ç§»æŒ‡ä»¤ï¼Œè½¬ç§»åˆ°ä¸­æ–­æºçš„ä¸­æ–­æœåŠ¡ç¨‹åºï¼Œå“åº”ä¸­æ–­

![image-20221214131504526](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221214131504526.png)

#### æ‰©å±•å¤–éƒ¨ROM

![image-20221214132319972](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221214132319972.png)

#### æ•°æ®å­˜å‚¨å™¨åœ°å€ç©ºé—´

1. ç‰‡å¤–RAM ï¼Œ64Kåœ°å€ç©ºé—´ï¼Œè®¿é—®æŒ‡ä»¤ MOVX
2. ç‰‡å†…RAM ï¼Œ256å­—èŠ‚åœ°å€ç©ºé—´ï¼Œè®¿é—®æŒ‡ä»¤MOV

- ä½128Bï¼ˆ00H~7FHï¼‰
  - å››ç»„å·¥ä½œå¯„å­˜å™¨
  - ä½å¯»å€åŒº
  - ç”¨æˆ·åŒº
- é«˜128Bï¼ˆ80H~FFHï¼‰ï¼ˆSFRç‰¹æ®ŠåŠŸèƒ½å¯„å­˜å™¨ï¼‰
  - ACC ç´¯åŠ å™¨
  - B å¯„å­˜å™¨B
  - PSW ç¨‹åºçŠ¶æ€å­—
  - SP æ ˆæŒ‡é’ˆ
  - DPTR æ•°æ®æŒ‡é’ˆ
  - P0~P3 4ä¸ªå¹¶å£

![image-20221214133008014](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221214133008014.png)

> 4ç»„å·¥ä½œå¯„å­˜å™¨ï¼Œä¸€ä¸ªæ—¶åˆ»åªæœ‰ä¸€ç»„èƒ½å·¥ä½œ

![image-20221214133501242](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221214133501242.png)

> é«˜128ä½å¯åˆ†ä¸º å¯ä½å¯»å€ å’Œ ä¸å¯ä½å¯»å€

![image-20221214133843542](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221214133843542.png)

#### å·¥ä½œå¯„å­˜å™¨

PSWçš„RS1 å’Œ RS0 å†³å®šå“ªä¸ªå·¥ä½œå¯„å­˜å™¨å·¥ä½œ

![image-20221214134244247](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221214134244247.png)

![image-20221214134302764](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221214134302764.png)

![image-20221214134638168](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221214134638168.png)

#### è®¿é—®å¤–éƒ¨ROM

![image-20221214135507821](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221214135507821.png)

> ç‰‡å†…ROMå’Œç‰‡å¤–ROM æœ‰ä¸€æ®µåœ°å€é‡åˆ ç”¨$\overline{EA}$æ§åˆ¶
>
> $\overline{EA}$ = 0ç‰‡å¤–
>
> $\overline{EA}$ = 1ç‰‡å†…
>
> è®¿é—®å¤–éƒ¨ROMæ—¶ï¼Œ$\overline{PSEN}$æœ‰æ•ˆ
>
> è®¿é—®ROMçš„æŒ‡ä»¤ MOVC

#### è®¿é—®RAM

![image-20221214140024842](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221214140024842.png)

> è®¿é—®ç‰‡å†…çš„æŒ‡ä»¤MOV è®¿é—®ç‰‡å¤–çš„æŒ‡ä»¤MOVX
>
> è®¿é—®ç‰‡å¤–RAMæ—¶ï¼Œ$\overline{RD}$ $\overline{WR}$ æœ‰æ•ˆ

### è¾“å…¥/è¾“å‡ºç«¯å£çš„ç»“æ„

- æ¯ä¸ªè¾“å…¥/è¾“å‡ºå£å 8ä½

- æ¯ä¸ªå£åŒ…æ‹¬ä¸€ä¸ªé”å­˜å™¨ï¼Œä¸€ä¸ªè¾“å‡ºé©±åŠ¨å™¨å’Œè¾“å…¥ç¼“å†²å™¨ã€‚

  è¾“å‡ºæ•°æ®æ—¶å¯ä»¥é”å­˜ï¼Œ è¾“å…¥æ•°æ®æ—¶å¯ä»¥ç¼“å†²ã€‚

- æ— ç‰‡å¤–å­˜å‚¨å™¨æ—¶ï¼Œæ¯ä¸ªç«¯å£ä¸ºå‡†åŒå‘I/Oï¼Œ

  æœ‰ç‰‡å¤–å­˜å‚¨å™¨æ—¶ï¼Œ

  - P0å£ï¼šä½å…«ä½åœ°å€å’Œæ•°æ®è¾“å…¥/è¾“å‡º
  - P2å£ï¼šé«˜å…«ä½åœ°å€

#### P0å£æŸä¸€ä½çš„ç»“æ„

![image-20221214143158048](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221214143158048.png)

1. P0å£ä½œä¸ºä¸€èˆ¬I/Oå£ä½¿ç”¨

- P0å£ç”¨ä½œè¾“å‡ºå£

  - ä¸€èˆ¬æ•°æ®è¾“å‡º
  - è¯»$\Rightarrow$ä¿®æ”¹$\Rightarrow$å†™  ï¼Œ ANL P0ï¼ŒA; ï¼ˆP0å£çš„æ•°æ®å’Œç´¯åŠ å™¨A åš ä¸è¿ç®— ï¼Œå†å°†ç»“æœä»P0å£è¾“å‡ºï¼‰

- P0å£ç”¨ä½œè¾“å…¥å£

  - ==ç«¯å£é”å­˜å™¨==è¦å…ˆå†™ "1"

    ```markdown
    MOV P0 , #0FFï¼›  //å¾€P0å£å†™1
    MOV A , P0;     //è¯»P0å£åˆ°ç´¯åŠ å™¨A
    ```

    $\because$ è¦è®©ä¸‰æç®¡T2æˆªæ­¢ ï¼Œå¤–éƒ¨ä¿¡å·æ‰èƒ½è¿›æ¥

2. P0å£ä½œä¸ºåœ°å€/æ•°æ®æ€»çº¿ä½¿ç”¨

#### P1å£

![image-20221214150644613](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221214150644613.png)

> æ²¡æœ‰åœ°å€/æ•°æ®æ€»çº¿

#### P2å£

![image-20221214150844521](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221214150844521.png)

> è®¿é—®å¤–éƒ¨å­˜å‚¨å™¨æ—¶ï¼Œè¦è¾“å‡ºé«˜8ä½çš„åœ°å€ï¼Œæœ‰åœ°å€çº¿çš„åŠŸèƒ½

#### P3å£

![image-20221214151015680](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221214151015680.png)

![image-20221214151033839](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221214151033839.png)

## å®šæ—¶å™¨

### å®šæ—¶å™¨æ¦‚è¿°

1. ä¸¤ä¸ª16ä½å®šæ—¶/è®¡æ•°å™¨T0 T1ï¼Œç”¨äºå®šæ—¶æ§åˆ¶ï¼Œå»¶æ—¶ï¼Œå¯¹å¤–éƒ¨äº‹ä»¶è®¡æ•°å’Œæ£€æµ‹ã€‚

2. å®šæ—¶å™¨T0 T1çš„ç»“æ„åŠä¸CPUçš„å…³ç³»

   å®šæ—¶å™¨çš„ç»„æˆ

   - T0ï¼šTH0ï¼ˆ8CHï¼‰ï¼ŒTL0ï¼ˆ8AHï¼‰
   - T1ï¼šTH1ï¼ˆ8DHï¼‰ï¼ŒTL1ï¼ˆ8BHï¼‰
   - TMOD   TCON

![image-20221214152411268](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221214152411268.png)

#### å®šæ—¶å·¥ä½œæ–¹å¼

å®šæ—¶å™¨å¯¹8051ç‰‡å†…æŒ¯è¡å™¨è¾“å‡ºç»12åˆ†é¢‘åçš„è„‰å†²è®¡æ•°

ï¼ˆå³æ¯ä¸ªæœºå™¨å‘¨æœŸä½¿å®šæ—¶å™¨çš„æ•°å€¼åŠ ä¸€ï¼‰

> 12åˆ†é¢‘ ï¼š æŠŠé¢‘ç‡é™¤ä»¥12 
>
> å¯¹äºå‘¨æœŸæ¥è¯´ ä¹˜ä»¥12

è‹¥fosc = 12MHZ ï¼Œ æ±‚è®¡æ•°é¢‘ç‡ï¼Ÿ

è®¡æ•°é¢‘ç‡$\frac{12}{12}$ = 1MHZ

$\because$  1ä¸ªæœºå™¨å‘¨æœŸ = 12ä¸ªæŒ¯è¡å‘¨æœŸ

$\therefore$ æ¯ç»è¿‡1ä¸ªæœºå™¨å‘¨æœŸï¼Œå®šæ—¶å™¨æ•°å€¼+1

![image-20221214153841724](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221214153841724.png)

#### è®¡æ•°å·¥ä½œæ–¹å¼

1. å¯¹å¤–éƒ¨è„‰å†²è®¡æ•° ï¼Œå¤–éƒ¨è¾“å…¥çš„è„‰å†²åœ¨è´Ÿè·³å˜æ—¶æœ‰æ•ˆ
2. å¤–éƒ¨å¼•è„šT0(P3.4)  T1(P3.5)

> æ±½è½¦è½®å­è½¬ä¸€åœˆï¼Œé€Ÿåº¦ä¼ æ„Ÿå™¨å‘é€ä¸€æ¬¡è„‰å†²ï¼Œè®¡æ•°å™¨è®¡æ•°ï¼Œä»è€Œç®—å‡ºè½¦é€Ÿ

### å®šæ—¶å™¨çš„æ§åˆ¶å­—

1. å·¥ä½œæ¨¡å¼å¯„å­˜å™¨ TMODï¼ˆ89Hï¼‰==ä¸å¯ä½å¯»å€==

- M1 M0 æ“ä½œæ¨¡å¼æ§åˆ¶ä½
- C/$\overline{T}$ è®¡æ•°å™¨æ–¹å¼/å®šæ—¶å™¨æ–¹å¼é€‰æ‹©ä½
- GATE é—¨æ§ä½

2.  æ§åˆ¶å¯„å­˜å™¨ TCONï¼ˆ88Hï¼‰==å¯ä½å¯»å€==

![image-20221214155418954](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221214155418954.png)

> ä½4ä½æ§åˆ¶å®šæ—¶å™¨T0
>
> é«˜4ä½æ§åˆ¶å®šæ—¶å™¨T1

> C/$\overline{T}$  C:counter    Tï¼štimer 
>
> å€¼ä¸º1 è®¡æ•°å™¨   å€¼ä¸º0 è®¡æ—¶å™¨

> T0çš„GATEé—¨æ§ä½   å†³å®šæ˜¯å¦å—åˆ° INT0 çš„æ§åˆ¶  å€¼ä¸º0 ä¸å—INT0çš„æ§åˆ¶

![image-20221214160131211](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221214160131211.png)

![image-20221214160731782](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221214160731782.png)

![image-20221214160759890](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221214160759890.png)

```markdown
setB TR0ï¼›  //å°†TROç½®1ï¼Œå¼€å¯å®šæ—¶å™¨T0
```

$\because$ TCON ==å¯ä½å¯»å€==

$\therefore$ ä¹Ÿå¯å¼•ç”¨8CH å¼€å¯ å®šæ—¶å™¨T0

### å®šæ—¶å™¨çš„å·¥ä½œæ¨¡å¼

1. æ¨¡å¼0

   13ä½å®šæ—¶å™¨ï¼ŒTL0(5ä½ï¼‰ï¼ŒTH0(8ä½ï¼‰

2. æ¨¡å¼1

   16ä½å®šæ—¶/è®°æ•°å™¨

3. æ¨¡å¼2

   å¯è‡ªåŠ¨é‡è£…è½½çš„8ä½å®šæ—¶/è®¡æ•°å™¨

4. æ¨¡å¼3

   - T0ï¼šä¸¤ä¸ªç‹¬ç«‹çš„8ä½å®šæ—¶/è®¡æ•°å™¨ 

   - T1ï¼šæ— æ¨¡å¼3

#### æ¨¡å¼1

![image-20221214162133352](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221214162133352.png)

> GATEä¸º0æ—¶ï¼Œå®šæ—¶å™¨åªå—TR0çš„å½±å“ï¼Œä¸INT0==æ— å…³==

> GATEä¸º1æ—¶ï¼Œå®šæ—¶å™¨å—==INT0å’ŒTR0==å…±åŒçš„å½±å“

**å·¥ä½œç‰¹ç‚¹**

- è¯¥æ¨¡å¼å¯¹åº”çš„æ˜¯ä¸€ä¸ª16ä½çš„å®šæ—¶å™¨/è®¡æ•°å™¨ã€‚

- ç”¨äºå®šæ—¶å·¥ä½œæ–¹å¼æ—¶ï¼Œå®šæ—¶æ—¶é—´ä¸º

  t=($2^{16}$ï¼T0åˆå€¼)Ã—æŒ¯è¡å‘¨æœŸÃ—12

- ç”¨äºè®¡æ•°å·¥ä½œæ–¹å¼æ—¶ï¼Œè®¡æ•°é•¿åº¦æœ€å¤§ä¸º

  $2^{16}$=65536ï¼ˆä¸ªå¤–éƒ¨è„‰å†²ï¼‰

- éœ€è¦åœ¨ä¸­æ–­ç¨‹åºé‡æ–°è£…å…¥å®šæ—¶å¸¸æ•°

#### æ¨¡å¼2

![image-20221214163230702](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221214163230702.png)

**å·¥ä½œç‰¹ç‚¹**

- è¯¥æ¨¡å¼æŠŠTL0(TL1)é…ç½®æˆä¸€ä¸ªå¯ä»¥==è‡ªåŠ¨é‡è£…è½½==çš„==8ä½==å®šæ—¶å™¨/è®¡æ•°å™¨ï¼Œå½“ TL0(TL1)åŠ æ»¡æº¢å‡ºåï¼ŒTH0(TH1)ä¸­çš„å®šæ—¶å¸¸æ•°è‡ªåŠ¨è£…å…¥TL0(TL1)

- åœ¨ç¨‹åºåˆå§‹åŒ–æ—¶ï¼ŒTL0å’ŒTH0ç”±è½¯ä»¶èµ‹äºˆç›¸åŒçš„åˆå€¼

- ç”¨äºå®šæ—¶å·¥ä½œæ–¹å¼æ—¶ï¼Œæœ€å¤§å®šæ—¶æ—¶é—´ä¸º

  t=($2^8$ï¼TH0åˆå€¼)Ã—æŒ¯è¡å‘¨æœŸÃ—12

- ç”¨äºè®¡æ•°å·¥ä½œæ–¹å¼æ—¶ï¼Œè®¡æ•°é•¿åº¦æœ€å¤§ä¸ºï¼š$2^8$=256ï¼ˆä¸ªå¤–éƒ¨è„‰å†²ï¼‰

#### æ¨¡å¼3

![image-20221214163651476](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/image-20221214163651476.png)

> åŸæœ¬æ§åˆ¶T1çš„TR1å’ŒTF1ï¼Œåœ¨æ¨¡å¼3ä¸­ æ§åˆ¶TH0

> T1é™¤äº†ä¸èƒ½æº¢å‡ºä¸­æ–­ï¼Œä¹Ÿèƒ½æ­£å¸¸å·¥ä½œï¼Œä¸æ–­åœ°æº¢å‡ºï¼Œé€‚åˆåšæ³¢ç‰¹ç‡å‘ç”Ÿå™¨

## ä¸­æ–­ç³»ç»Ÿ

#### å¾®æœºçš„è¾“å…¥è¾“å‡ºæ–¹å¼

> 1. æ— æ¡ä»¶ä¼ é€æ–¹å¼ï¼šå¤–è®¾æ€»æ˜¯å¤„äºâ€œå‡†å¤‡å¥½â€çŠ¶æ€
> 2. æŸ¥è¯¢ä¼ é€æ–¹å¼ï¼šæŸ¥è¯¢å¤–è®¾æ˜¯å¦å‡†å¤‡å¥½
> 3. ç›´æ¥å­˜å‚¨å™¨DMAæ–¹å¼ï¼šå¤–è®¾å’Œå­˜å‚¨å™¨ç›´æ¥ä¼ é€’æ•°æ®
> 4. ä¸­æ–­ä¼ é€æ–¹å¼ï¼šå¤–è®¾ç”³è¯·ä¸­æ–­

#### ä¸­æ–­çš„æ¦‚å¿µ

> å½“CPUæ­£åœ¨å·¥ä½œçš„æ—¶å€™ï¼Œå¤–éƒ¨å‘ç”Ÿçš„æŸä¸€ä»¶äº‹æƒ…å‘CPUå‘å‡ºä¸€ä¸ªè¯·æ±‚ï¼Œ è¯·æ±‚å®ƒè¿…é€Ÿå»å¤„ç†ï¼ŒCPUæš‚æ—¶ä¸­æ­¢å½“å‰çš„å·¥ä½œï¼Œè½¬å»å¤„ç†è¯¥äº‹ä»¶ï¼Œå¤„ç†å®Œä¹‹åè¿” å›ä¸­æ­¢å¤„ï¼Œç»§ç»­åŸæ¥çš„å·¥ä½œ

#### ä¸­æ–­çš„ç»„æˆ

- ä¸­æ–­ç³»ç»Ÿ
  - å®ç°ä¸­æ–­åŠŸèƒ½çš„éƒ¨ä»¶
- ä¸­æ–­æº
  - äº§ç”Ÿä¸­æ–­çš„è¯·æ±‚

> ä¸­æ–­æºçš„ç§ç±»:
>
> 1. å¤–éƒ¨è®¾å¤‡ä¸­æ–­
> 2. æ§åˆ¶å¯¹è±¡ä¸­æ–­
> 3. æ•…éšœä¸­æ–­
> 4. å®šæ—¶è„‰å†²ä¸­æ–­

#### ä¸­æ–­çš„ä½œç”¨

> ä½¿è®¡ç®—æœºå…·æœ‰å®æ—¶å¤„ç†åŠŸèƒ½ï¼Œå¯¹éšæœºå‘ç”Ÿçš„äº‹ä»¶ä½œå‡ºåŠæ—¶å¤„ç†

#### ä¸­æ–­çš„ä¼˜å…ˆçº§

> ä¸­æ–­é«˜ä¼˜å…ˆçº§å’Œä¸­æ–­ä½ä¼˜å…ˆçº§

> åŒçº§çš„ä¼˜å…ˆçº§æ’åº

![image-20230307161614094](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/202303071616138.png)

#### ä¸­æ–­çš„åµŒå¥—

![image-20230307154536312](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/202303071545357.png)

#### ä¸­æ–­çš„è¿‡ç¨‹

> ä¸­æ–­å“åº”è¿‡ç¨‹
>
> 1. ä¿æŠ¤ç°åœº
>
>    - å°†æ–­ç‚¹åœ°å€(PCå€¼)å‹å…¥å †æ ˆ,ä¿æŠ¤Rå¯„å­˜å™¨,ACC,æ ‡å¿—ä½ä¿¡æ¯
>
> 2. æ ¹æ®ä¸­æ–­çŸ¢é‡åœ°å€è½¬åˆ°ä¸­æ–­æœåŠ¡ç¨‹åº
>
>    - å¦‚æœä¸å¸Œæœ›æœ‰æ›´é«˜çº§çš„ä¸­æ–­æ‰“æ‰°ï¼Œå¯ä»¥å…³é—­ä¸­æ–­
>
>    ![image-20230307162102210](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/202303071621257.png)
>
> 3. ç°åœºæ¢å¤
>
>    - æ¢å¤Rå¯„å­˜å™¨,ACC,æ ‡å¿—ä½ä¿¡æ¯ æ‰§è¡Œä¸­æ–­è¿”å›æŒ‡ä»¤,è‡ªåŠ¨å¼¹å‡ºæ–­ç‚¹åˆ°PC,è¿”å›ä¸»ç¨‹åº, ç»§ç»­æ‰§è¡Œè¢«ä¸­æ–­çš„ä¸»ç¨‹åº

![image-20230307155140268](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/202303071551318.png)

### ä¸­æ–­ç³»ç»Ÿç»“æ„

> - 5ä¸ªä¸­æ–­æº
>
>   - å¤–éƒ¨ä¸­æ–­æº ï¼šINT0 INT1ï¼ˆP3.2 P3.3å¼•è„šï¼‰
>
>   ![image-20230307155458308](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/202303071554347.png)
>
>   - å†…éƒ¨ä¸­æ–­æºï¼šå®šæ—¶å™¨ä¸­æ–­ï¼šTF0 TF1 ä¸²å£ä¸­æ–­ï¼šTI RI

![image-20230307160918769](https://typora-notes-codervv.oss-cn-shanghai.aliyuncs.com/img_for_typora/202303071609824.png)

## å¾€åéƒ½æ˜¯æ±‡ç¼–æŒ‡ä»¤æ“ä½œ51ï¼Œä»¥åæœ‰æœºä¼šå†å­¦
